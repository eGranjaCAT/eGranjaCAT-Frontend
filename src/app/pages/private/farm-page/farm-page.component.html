<div class="p-4">
  <!-- Encabezado -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-2xl font-bold">Gestión de Granjas</h1>
      <p class="text-gray-500">Administra todas las granjas del sistema</p>
    </div>
    <p-button 
      label="Añadir Granja" 
      icon="pi pi-plus" 
      oclass="p-button-success" 
      (onClick)="mostrarFormulario = true">
    </p-button>
  </div>

  <!-- Tarjetas de resumen -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
    <div class="bg-white shadow rounded-lg p-4 flex items-center justify-between">
      <div>
        <p class="text-gray-500">Total de granjas</p>
        <p class="text-3xl font-bold">{{ granjas.length }}</p>
      </div>
      <i class="pi pi-building text-blue-500 text-3xl"></i>
    </div>
    <div class="bg-white shadow rounded-lg p-4 flex items-center justify-between">
      <div>
        <p class="text-gray-500">Granjas activas</p>
        <p class="text-3xl font-bold text-green-600">
          {{ granjasActivasCount}}
        </p>
      </div>
      <i class="pi pi-check-circle text-green-500 text-3xl"></i>
    </div>
    <div class="bg-white shadow rounded-lg p-4 flex items-center justify-between">
      <div>
        <p class="text-gray-500">Granjas inactivas</p>
        <p class="text-3xl font-bold text-red-600">
          {{ granjasInactivasCount }}
        </p>
      </div>
      <i class="pi pi-times-circle text-red-500 text-3xl"></i>
    </div>
  </div>

  <!-- Barra de búsqueda -->
  <div class="flex justify-between items-center mb-4">
    <div class="flex items-center gap-2">
      <input type="text" pInputText placeholder="Buscar granjas..." [(ngModel)]="filtro" (input)="filtrarGranjas()"
        class="w-64" />
      <p-button icon="pi pi-filter" label="Filtrar" styleClass="p-button-secondary"></p-button>
    </div>
    <p-button icon="pi pi-download" label="Exportar" styleClass="p-button-secondary"></p-button>
  </div>

  <!-- Tabla -->
 <p-table 
  [value]="granjasFiltradas" 
  [paginator]="true" 
  [rows]="5" 
  [responsiveLayout]="'scroll'">
  <ng-template pTemplate="header">
    <tr>
      <th>Nombre</th>
      <th>Ubicación</th>
      <th>Contacto</th>
      <th>Lotes</th>
      <th>Estado</th>
      <th>Acciones</th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-g>
    <tr>
      <td>
        <div class="flex items-center gap-2">
          <i class="pi pi-building text-green-500"></i>
          <div>
            <p class="font-semibold">{{ g.nombre }}</p>
            <p class="text-gray-500 text-sm">ID: {{ g.id }}</p>
          </div>
        </div>
      </td>
      <td>{{ g.ubicacion }}</td>
      <td>
        <p><i class="pi pi-phone mr-2"></i> {{ g.telefono }}</p>
        <p><i class="pi pi-envelope mr-2"></i> {{ g.email }}</p>
      </td>
      <td>{{ g.lotes }}</td>
      <td>
        <span class="px-2 py-1 rounded text-sm"
          [ngClass]="{
            'bg-green-100 text-green-600': g.estado === 'Activa',
            'bg-red-100 text-red-600': g.estado === 'Inactiva'
          }">
          {{ g.estado }}
        </span>
      </td>
      <td>
        <div class="card flex justify-center">
          <p-button 
            (click)="menu.toggle($event); $event.stopPropagation(); menu.model = getMenuItems(g)" 
            icon="pi pi-ellipsis-v" />
        </div>
      </td>
    </tr>
  </ng-template>
</p-table>

  <p-menu #menu [model]="items" [popup]="true"></p-menu>

  <p-dialog header="Nueva Granja" [(visible)]="mostrarFormulario" [modal]="true" [closable]="true">
  <app-farm-form (guardar)="nuevaGranja($event)"></app-farm-form>
  </p-dialog>

  <p-dialog header="Confirmar eliminación" [(visible)]="mostrarConfirmarBorrar" [modal]="true" [closable]="true">
  <p>¿Estás seguro de que quieres eliminar la granja "{{ granjaAEliminar?.nombre }}"?</p>
  <div class="flex justify-end gap-2 mt-4">
    <p-button label="Cancelar" (onClick)="mostrarConfirmarBorrar = false" class="p-button-secondary"></p-button>
    <p-button label="Eliminar" (onClick)="eliminarGranja()" class="p-button-secondary"></p-button>
  </div>
</p-dialog>

</div>